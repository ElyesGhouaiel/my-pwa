{"ast":null,"code":"\"use strict\";\n\n/*!\r\n * Copyright 2019 Google Inc. All Rights Reserved.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ResourceStream = void 0;\nconst stream_1 = require(\"stream\");\nclass ResourceStream extends stream_1.Transform {\n  constructor(args, requestFn) {\n    const options = Object.assign({\n      objectMode: true\n    }, args.streamOptions);\n    super(options);\n    this._ended = false;\n    this._maxApiCalls = args.maxApiCalls === -1 ? Infinity : args.maxApiCalls;\n    this._nextQuery = args.query;\n    this._reading = false;\n    this._requestFn = requestFn;\n    this._requestsMade = 0;\n    this._resultsToSend = args.maxResults === -1 ? Infinity : args.maxResults;\n    this._otherArgs = [];\n  }\n  /* eslint-disable  @typescript-eslint/no-explicit-any */\n  end(...args) {\n    this._ended = true;\n    return super.end(...args);\n  }\n  _read() {\n    if (this._reading) {\n      return;\n    }\n    this._reading = true;\n    // Wrap in a try/catch to catch input linting errors, e.g.\n    // an invalid BigQuery query. These errors are thrown in an\n    // async fashion, which makes them un-catchable by the user.\n    try {\n      this._requestFn(this._nextQuery, (err, results, nextQuery, ...otherArgs) => {\n        if (err) {\n          this.destroy(err);\n          return;\n        }\n        this._otherArgs = otherArgs;\n        this._nextQuery = nextQuery;\n        if (this._resultsToSend !== Infinity) {\n          results = results.splice(0, this._resultsToSend);\n          this._resultsToSend -= results.length;\n        }\n        let more = true;\n        for (const result of results) {\n          if (this._ended) {\n            break;\n          }\n          more = this.push(result);\n        }\n        const isFinished = !this._nextQuery || this._resultsToSend < 1;\n        const madeMaxCalls = ++this._requestsMade >= this._maxApiCalls;\n        if (isFinished || madeMaxCalls) {\n          this.end();\n        }\n        if (more && !this._ended) {\n          setImmediate(() => this._read());\n        }\n        this._reading = false;\n      });\n    } catch (e) {\n      this.destroy(e);\n    }\n  }\n}\nexports.ResourceStream = ResourceStream;","map":{"version":3,"names":["Object","defineProperty","exports","value","ResourceStream","stream_1","require","Transform","constructor","args","requestFn","options","assign","objectMode","streamOptions","_ended","_maxApiCalls","maxApiCalls","Infinity","_nextQuery","query","_reading","_requestFn","_requestsMade","_resultsToSend","maxResults","_otherArgs","end","_read","err","results","nextQuery","otherArgs","destroy","splice","length","more","result","push","isFinished","madeMaxCalls","setImmediate","e"],"sources":["C:/Users/yujir/Documents/ynov/app pwa/mypwafinal/my-pwa/node_modules/@google-cloud/paginator/build/src/resource-stream.js"],"sourcesContent":["\"use strict\";\r\n/*!\r\n * Copyright 2019 Google Inc. All Rights Reserved.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ResourceStream = void 0;\r\nconst stream_1 = require(\"stream\");\r\nclass ResourceStream extends stream_1.Transform {\r\n    constructor(args, requestFn) {\r\n        const options = Object.assign({ objectMode: true }, args.streamOptions);\r\n        super(options);\r\n        this._ended = false;\r\n        this._maxApiCalls = args.maxApiCalls === -1 ? Infinity : args.maxApiCalls;\r\n        this._nextQuery = args.query;\r\n        this._reading = false;\r\n        this._requestFn = requestFn;\r\n        this._requestsMade = 0;\r\n        this._resultsToSend = args.maxResults === -1 ? Infinity : args.maxResults;\r\n        this._otherArgs = [];\r\n    }\r\n    /* eslint-disable  @typescript-eslint/no-explicit-any */\r\n    end(...args) {\r\n        this._ended = true;\r\n        return super.end(...args);\r\n    }\r\n    _read() {\r\n        if (this._reading) {\r\n            return;\r\n        }\r\n        this._reading = true;\r\n        // Wrap in a try/catch to catch input linting errors, e.g.\r\n        // an invalid BigQuery query. These errors are thrown in an\r\n        // async fashion, which makes them un-catchable by the user.\r\n        try {\r\n            this._requestFn(this._nextQuery, (err, results, nextQuery, ...otherArgs) => {\r\n                if (err) {\r\n                    this.destroy(err);\r\n                    return;\r\n                }\r\n                this._otherArgs = otherArgs;\r\n                this._nextQuery = nextQuery;\r\n                if (this._resultsToSend !== Infinity) {\r\n                    results = results.splice(0, this._resultsToSend);\r\n                    this._resultsToSend -= results.length;\r\n                }\r\n                let more = true;\r\n                for (const result of results) {\r\n                    if (this._ended) {\r\n                        break;\r\n                    }\r\n                    more = this.push(result);\r\n                }\r\n                const isFinished = !this._nextQuery || this._resultsToSend < 1;\r\n                const madeMaxCalls = ++this._requestsMade >= this._maxApiCalls;\r\n                if (isFinished || madeMaxCalls) {\r\n                    this.end();\r\n                }\r\n                if (more && !this._ended) {\r\n                    setImmediate(() => this._read());\r\n                }\r\n                this._reading = false;\r\n            });\r\n        }\r\n        catch (e) {\r\n            this.destroy(e);\r\n        }\r\n    }\r\n}\r\nexports.ResourceStream = ResourceStream;\r\n//# sourceMappingURL=resource-stream.js.map"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}