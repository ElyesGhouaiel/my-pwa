{"ast":null,"code":"/*! firebase-admin v13.0.1 */\n\"use strict\";\n\n/*!\r\n * Copyright 2020 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Model = exports.MachineLearning = void 0;\nconst index_1 = require(\"../storage/index\");\nconst error_1 = require(\"../utils/error\");\nconst validator = require(\"../utils/validator\");\nconst deep_copy_1 = require(\"../utils/deep-copy\");\nconst utils = require(\"../utils\");\nconst machine_learning_api_client_1 = require(\"./machine-learning-api-client\");\nconst machine_learning_utils_1 = require(\"./machine-learning-utils\");\n/**\r\n * The Firebase `MachineLearning` service interface.\r\n */\nclass MachineLearning {\n  /**\r\n   * @param app - The app for this ML service.\r\n   * @constructor\r\n   * @internal\r\n   */\n  constructor(app) {\n    if (!validator.isNonNullObject(app) || !('options' in app)) {\n      throw new error_1.FirebaseError({\n        code: 'machine-learning/invalid-argument',\n        message: 'First argument passed to admin.machineLearning() must be a ' + 'valid Firebase app instance.'\n      });\n    }\n    this.appInternal = app;\n    this.client = new machine_learning_api_client_1.MachineLearningApiClient(app);\n  }\n  /**\r\n   *  The {@link firebase-admin.app#App} associated with the current `MachineLearning`\r\n   *  service instance.\r\n   */\n  get app() {\n    return this.appInternal;\n  }\n  /**\r\n   * Creates a model in the current Firebase project.\r\n   *\r\n   * @param model - The model to create.\r\n   *\r\n   * @returns A Promise fulfilled with the created model.\r\n   */\n  createModel(model) {\n    return this.signUrlIfPresent(model).then(modelContent => this.client.createModel(modelContent)).then(operation => this.client.handleOperation(operation)).then(modelResponse => new Model(modelResponse, this.client));\n  }\n  /**\r\n   * Updates a model's metadata or model file.\r\n   *\r\n   * @param modelId - The ID of the model to update.\r\n   * @param model - The model fields to update.\r\n   *\r\n   * @returns A Promise fulfilled with the updated model.\r\n   */\n  updateModel(modelId, model) {\n    const updateMask = utils.generateUpdateMask(model);\n    return this.signUrlIfPresent(model).then(modelContent => this.client.updateModel(modelId, modelContent, updateMask)).then(operation => this.client.handleOperation(operation)).then(modelResponse => new Model(modelResponse, this.client));\n  }\n  /**\r\n   * Publishes a Firebase ML model.\r\n   *\r\n   * A published model can be downloaded to client apps.\r\n   *\r\n   * @param modelId - The ID of the model to publish.\r\n   *\r\n   * @returns A Promise fulfilled with the published model.\r\n   */\n  publishModel(modelId) {\n    return this.setPublishStatus(modelId, true);\n  }\n  /**\r\n   * Unpublishes a Firebase ML model.\r\n   *\r\n   * @param modelId - The ID of the model to unpublish.\r\n   *\r\n   * @returns A Promise fulfilled with the unpublished model.\r\n   */\n  unpublishModel(modelId) {\n    return this.setPublishStatus(modelId, false);\n  }\n  /**\r\n   * Gets the model specified by the given ID.\r\n   *\r\n   * @param modelId - The ID of the model to get.\r\n   *\r\n   * @returns A Promise fulfilled with the model object.\r\n   */\n  getModel(modelId) {\n    return this.client.getModel(modelId).then(modelResponse => new Model(modelResponse, this.client));\n  }\n  /**\r\n   * Lists the current project's models.\r\n   *\r\n   * @param options - The listing options.\r\n   *\r\n   * @returns A promise that\r\n   *     resolves with the current (filtered) list of models and the next page\r\n   *     token. For the last page, an empty list of models and no page token\r\n   *     are returned.\r\n   */\n  listModels(options = {}) {\n    return this.client.listModels(options).then(resp => {\n      if (!validator.isNonNullObject(resp)) {\n        throw new machine_learning_utils_1.FirebaseMachineLearningError('invalid-argument', `Invalid ListModels response: ${JSON.stringify(resp)}`);\n      }\n      let models = [];\n      if (resp.models) {\n        models = resp.models.map(rs => new Model(rs, this.client));\n      }\n      const result = {\n        models\n      };\n      if (resp.nextPageToken) {\n        result.pageToken = resp.nextPageToken;\n      }\n      return result;\n    });\n  }\n  /**\r\n   * Deletes a model from the current project.\r\n   *\r\n   * @param modelId - The ID of the model to delete.\r\n   */\n  deleteModel(modelId) {\n    return this.client.deleteModel(modelId);\n  }\n  setPublishStatus(modelId, publish) {\n    const updateMask = ['state.published'];\n    const options = {\n      state: {\n        published: publish\n      }\n    };\n    return this.client.updateModel(modelId, options, updateMask).then(operation => this.client.handleOperation(operation)).then(modelResponse => new Model(modelResponse, this.client));\n  }\n  signUrlIfPresent(options) {\n    const modelOptions = (0, deep_copy_1.deepCopy)(options);\n    if ((0, machine_learning_api_client_1.isGcsTfliteModelOptions)(modelOptions)) {\n      return this.signUrl(modelOptions.tfliteModel.gcsTfliteUri).then(uri => {\n        modelOptions.tfliteModel.gcsTfliteUri = uri;\n        return modelOptions;\n      }).catch(err => {\n        throw new machine_learning_utils_1.FirebaseMachineLearningError('internal-error', `Error during signing upload url: ${err.message}`);\n      });\n    }\n    return Promise.resolve(modelOptions);\n  }\n  signUrl(unsignedUrl) {\n    const MINUTES_IN_MILLIS = 60 * 1000;\n    const URL_VALID_DURATION = 10 * MINUTES_IN_MILLIS;\n    const gcsRegex = /^gs:\\/\\/([a-z0-9_.-]{3,63})\\/(.+)$/;\n    const matches = gcsRegex.exec(unsignedUrl);\n    if (!matches) {\n      throw new machine_learning_utils_1.FirebaseMachineLearningError('invalid-argument', `Invalid unsigned url: ${unsignedUrl}`);\n    }\n    const bucketName = matches[1];\n    const blobName = matches[2];\n    const bucket = (0, index_1.getStorage)(this.app).bucket(bucketName);\n    const blob = bucket.file(blobName);\n    return blob.getSignedUrl({\n      action: 'read',\n      expires: Date.now() + URL_VALID_DURATION\n    }).then(signUrl => signUrl[0]);\n  }\n}\nexports.MachineLearning = MachineLearning;\n/**\r\n * A Firebase ML Model output object.\r\n */\nclass Model {\n  /**\r\n   * @internal\r\n   */\n  constructor(model, client) {\n    this.model = Model.validateAndClone(model);\n    this.client = client;\n  }\n  /** The ID of the model. */\n  get modelId() {\n    return extractModelId(this.model.name);\n  }\n  /**\r\n   * The model's name. This is the name you use from your app to load the\r\n   * model.\r\n   */\n  get displayName() {\n    return this.model.displayName;\n  }\n  /**\r\n   * The model's tags, which can be used to group or filter models in list\r\n   * operations.\r\n   */\n  get tags() {\n    return this.model.tags || [];\n  }\n  /** The timestamp of the model's creation. */\n  get createTime() {\n    return new Date(this.model.createTime).toUTCString();\n  }\n  /** The timestamp of the model's most recent update. */\n  get updateTime() {\n    return new Date(this.model.updateTime).toUTCString();\n  }\n  /** Error message when model validation fails. */\n  get validationError() {\n    return this.model.state?.validationError?.message;\n  }\n  /** True if the model is published. */\n  get published() {\n    return this.model.state?.published || false;\n  }\n  /**\r\n   * The ETag identifier of the current version of the model. This value\r\n   * changes whenever you update any of the model's properties.\r\n   */\n  get etag() {\n    return this.model.etag;\n  }\n  /**\r\n   * The hash of the model's `tflite` file. This value changes only when\r\n   * you upload a new TensorFlow Lite model.\r\n   */\n  get modelHash() {\n    return this.model.modelHash;\n  }\n  /** Metadata about the model's TensorFlow Lite model file. */\n  get tfliteModel() {\n    // Make a copy so people can't directly modify the private this.model object.\n    return (0, deep_copy_1.deepCopy)(this.model.tfliteModel);\n  }\n  /**\r\n   * True if the model is locked by a server-side operation. You can't make\r\n   * changes to a locked model. See {@link Model.waitForUnlocked}.\r\n   */\n  get locked() {\n    return (this.model.activeOperations?.length ?? 0) > 0;\n  }\n  /**\r\n   * Return the model as a JSON object.\r\n   */\n  toJSON() {\n    // We can't just return this.model because it has extra fields and\n    // different formats etc. So we build the expected model object.\n    const jsonModel = {\n      modelId: this.modelId,\n      displayName: this.displayName,\n      tags: this.tags,\n      createTime: this.createTime,\n      updateTime: this.updateTime,\n      published: this.published,\n      etag: this.etag,\n      locked: this.locked\n    };\n    // Also add possibly undefined fields if they exist.\n    if (this.validationError) {\n      jsonModel['validationError'] = this.validationError;\n    }\n    if (this.modelHash) {\n      jsonModel['modelHash'] = this.modelHash;\n    }\n    if (this.tfliteModel) {\n      jsonModel['tfliteModel'] = this.tfliteModel;\n    }\n    return jsonModel;\n  }\n  /**\r\n   * Wait for the model to be unlocked.\r\n   *\r\n   * @param maxTimeMillis - The maximum time in milliseconds to wait.\r\n   *     If not specified, a default maximum of 2 minutes is used.\r\n   *\r\n   * @returns A promise that resolves when the model is unlocked\r\n   *   or the maximum wait time has passed.\r\n   */\n  waitForUnlocked(maxTimeMillis) {\n    if ((this.model.activeOperations?.length ?? 0) > 0) {\n      // The client will always be defined on Models that have activeOperations\n      // because models with active operations came back from the server and\n      // were constructed with a non-empty client.\n      return this.client.handleOperation(this.model.activeOperations[0], {\n        wait: true,\n        maxTimeMillis\n      }).then(modelResponse => {\n        this.model = Model.validateAndClone(modelResponse);\n      });\n    }\n    return Promise.resolve();\n  }\n  static validateAndClone(model) {\n    if (!validator.isNonNullObject(model) || !validator.isNonEmptyString(model.name) || !validator.isNonEmptyString(model.createTime) || !validator.isNonEmptyString(model.updateTime) || !validator.isNonEmptyString(model.displayName) || !validator.isNonEmptyString(model.etag)) {\n      throw new machine_learning_utils_1.FirebaseMachineLearningError('invalid-server-response', `Invalid Model response: ${JSON.stringify(model)}`);\n    }\n    const tmpModel = (0, deep_copy_1.deepCopy)(model);\n    // If tflite Model is specified, it must have a source of {gcsTfliteUri}\n    if (model.tfliteModel && !validator.isNonEmptyString(model.tfliteModel.gcsTfliteUri)) {\n      // If we have some other source, ignore the whole tfliteModel.\n      delete tmpModel.tfliteModel;\n    }\n    // Remove '@type' field. We don't need it.\n    if (tmpModel['@type']) {\n      delete tmpModel['@type'];\n    }\n    return tmpModel;\n  }\n}\nexports.Model = Model;\nfunction extractModelId(resourceName) {\n  return resourceName.split('/').pop();\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","Model","MachineLearning","index_1","require","error_1","validator","deep_copy_1","utils","machine_learning_api_client_1","machine_learning_utils_1","constructor","app","isNonNullObject","FirebaseError","code","message","appInternal","client","MachineLearningApiClient","createModel","model","signUrlIfPresent","then","modelContent","operation","handleOperation","modelResponse","updateModel","modelId","updateMask","generateUpdateMask","publishModel","setPublishStatus","unpublishModel","getModel","listModels","options","resp","FirebaseMachineLearningError","JSON","stringify","models","map","rs","result","nextPageToken","pageToken","deleteModel","publish","state","published","modelOptions","deepCopy","isGcsTfliteModelOptions","signUrl","tfliteModel","gcsTfliteUri","uri","catch","err","Promise","resolve","unsignedUrl","MINUTES_IN_MILLIS","URL_VALID_DURATION","gcsRegex","matches","exec","bucketName","blobName","bucket","getStorage","blob","file","getSignedUrl","action","expires","Date","now","validateAndClone","extractModelId","name","displayName","tags","createTime","toUTCString","updateTime","validationError","etag","modelHash","locked","activeOperations","length","toJSON","jsonModel","waitForUnlocked","maxTimeMillis","wait","isNonEmptyString","tmpModel","resourceName","split","pop"],"sources":["C:/Users/yujir/Documents/ynov/app pwa/mypwafinal/my-pwa/node_modules/firebase-admin/lib/machine-learning/machine-learning.js"],"sourcesContent":["/*! firebase-admin v13.0.1 */\r\n\"use strict\";\r\n/*!\r\n * Copyright 2020 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Model = exports.MachineLearning = void 0;\r\nconst index_1 = require(\"../storage/index\");\r\nconst error_1 = require(\"../utils/error\");\r\nconst validator = require(\"../utils/validator\");\r\nconst deep_copy_1 = require(\"../utils/deep-copy\");\r\nconst utils = require(\"../utils\");\r\nconst machine_learning_api_client_1 = require(\"./machine-learning-api-client\");\r\nconst machine_learning_utils_1 = require(\"./machine-learning-utils\");\r\n/**\r\n * The Firebase `MachineLearning` service interface.\r\n */\r\nclass MachineLearning {\r\n    /**\r\n     * @param app - The app for this ML service.\r\n     * @constructor\r\n     * @internal\r\n     */\r\n    constructor(app) {\r\n        if (!validator.isNonNullObject(app) || !('options' in app)) {\r\n            throw new error_1.FirebaseError({\r\n                code: 'machine-learning/invalid-argument',\r\n                message: 'First argument passed to admin.machineLearning() must be a ' +\r\n                    'valid Firebase app instance.',\r\n            });\r\n        }\r\n        this.appInternal = app;\r\n        this.client = new machine_learning_api_client_1.MachineLearningApiClient(app);\r\n    }\r\n    /**\r\n     *  The {@link firebase-admin.app#App} associated with the current `MachineLearning`\r\n     *  service instance.\r\n     */\r\n    get app() {\r\n        return this.appInternal;\r\n    }\r\n    /**\r\n     * Creates a model in the current Firebase project.\r\n     *\r\n     * @param model - The model to create.\r\n     *\r\n     * @returns A Promise fulfilled with the created model.\r\n     */\r\n    createModel(model) {\r\n        return this.signUrlIfPresent(model)\r\n            .then((modelContent) => this.client.createModel(modelContent))\r\n            .then((operation) => this.client.handleOperation(operation))\r\n            .then((modelResponse) => new Model(modelResponse, this.client));\r\n    }\r\n    /**\r\n     * Updates a model's metadata or model file.\r\n     *\r\n     * @param modelId - The ID of the model to update.\r\n     * @param model - The model fields to update.\r\n     *\r\n     * @returns A Promise fulfilled with the updated model.\r\n     */\r\n    updateModel(modelId, model) {\r\n        const updateMask = utils.generateUpdateMask(model);\r\n        return this.signUrlIfPresent(model)\r\n            .then((modelContent) => this.client.updateModel(modelId, modelContent, updateMask))\r\n            .then((operation) => this.client.handleOperation(operation))\r\n            .then((modelResponse) => new Model(modelResponse, this.client));\r\n    }\r\n    /**\r\n     * Publishes a Firebase ML model.\r\n     *\r\n     * A published model can be downloaded to client apps.\r\n     *\r\n     * @param modelId - The ID of the model to publish.\r\n     *\r\n     * @returns A Promise fulfilled with the published model.\r\n     */\r\n    publishModel(modelId) {\r\n        return this.setPublishStatus(modelId, true);\r\n    }\r\n    /**\r\n     * Unpublishes a Firebase ML model.\r\n     *\r\n     * @param modelId - The ID of the model to unpublish.\r\n     *\r\n     * @returns A Promise fulfilled with the unpublished model.\r\n     */\r\n    unpublishModel(modelId) {\r\n        return this.setPublishStatus(modelId, false);\r\n    }\r\n    /**\r\n     * Gets the model specified by the given ID.\r\n     *\r\n     * @param modelId - The ID of the model to get.\r\n     *\r\n     * @returns A Promise fulfilled with the model object.\r\n     */\r\n    getModel(modelId) {\r\n        return this.client.getModel(modelId)\r\n            .then((modelResponse) => new Model(modelResponse, this.client));\r\n    }\r\n    /**\r\n     * Lists the current project's models.\r\n     *\r\n     * @param options - The listing options.\r\n     *\r\n     * @returns A promise that\r\n     *     resolves with the current (filtered) list of models and the next page\r\n     *     token. For the last page, an empty list of models and no page token\r\n     *     are returned.\r\n     */\r\n    listModels(options = {}) {\r\n        return this.client.listModels(options)\r\n            .then((resp) => {\r\n            if (!validator.isNonNullObject(resp)) {\r\n                throw new machine_learning_utils_1.FirebaseMachineLearningError('invalid-argument', `Invalid ListModels response: ${JSON.stringify(resp)}`);\r\n            }\r\n            let models = [];\r\n            if (resp.models) {\r\n                models = resp.models.map((rs) => new Model(rs, this.client));\r\n            }\r\n            const result = { models };\r\n            if (resp.nextPageToken) {\r\n                result.pageToken = resp.nextPageToken;\r\n            }\r\n            return result;\r\n        });\r\n    }\r\n    /**\r\n     * Deletes a model from the current project.\r\n     *\r\n     * @param modelId - The ID of the model to delete.\r\n     */\r\n    deleteModel(modelId) {\r\n        return this.client.deleteModel(modelId);\r\n    }\r\n    setPublishStatus(modelId, publish) {\r\n        const updateMask = ['state.published'];\r\n        const options = { state: { published: publish } };\r\n        return this.client.updateModel(modelId, options, updateMask)\r\n            .then((operation) => this.client.handleOperation(operation))\r\n            .then((modelResponse) => new Model(modelResponse, this.client));\r\n    }\r\n    signUrlIfPresent(options) {\r\n        const modelOptions = (0, deep_copy_1.deepCopy)(options);\r\n        if ((0, machine_learning_api_client_1.isGcsTfliteModelOptions)(modelOptions)) {\r\n            return this.signUrl(modelOptions.tfliteModel.gcsTfliteUri)\r\n                .then((uri) => {\r\n                modelOptions.tfliteModel.gcsTfliteUri = uri;\r\n                return modelOptions;\r\n            })\r\n                .catch((err) => {\r\n                throw new machine_learning_utils_1.FirebaseMachineLearningError('internal-error', `Error during signing upload url: ${err.message}`);\r\n            });\r\n        }\r\n        return Promise.resolve(modelOptions);\r\n    }\r\n    signUrl(unsignedUrl) {\r\n        const MINUTES_IN_MILLIS = 60 * 1000;\r\n        const URL_VALID_DURATION = 10 * MINUTES_IN_MILLIS;\r\n        const gcsRegex = /^gs:\\/\\/([a-z0-9_.-]{3,63})\\/(.+)$/;\r\n        const matches = gcsRegex.exec(unsignedUrl);\r\n        if (!matches) {\r\n            throw new machine_learning_utils_1.FirebaseMachineLearningError('invalid-argument', `Invalid unsigned url: ${unsignedUrl}`);\r\n        }\r\n        const bucketName = matches[1];\r\n        const blobName = matches[2];\r\n        const bucket = (0, index_1.getStorage)(this.app).bucket(bucketName);\r\n        const blob = bucket.file(blobName);\r\n        return blob.getSignedUrl({\r\n            action: 'read',\r\n            expires: Date.now() + URL_VALID_DURATION,\r\n        }).then((signUrl) => signUrl[0]);\r\n    }\r\n}\r\nexports.MachineLearning = MachineLearning;\r\n/**\r\n * A Firebase ML Model output object.\r\n */\r\nclass Model {\r\n    /**\r\n     * @internal\r\n     */\r\n    constructor(model, client) {\r\n        this.model = Model.validateAndClone(model);\r\n        this.client = client;\r\n    }\r\n    /** The ID of the model. */\r\n    get modelId() {\r\n        return extractModelId(this.model.name);\r\n    }\r\n    /**\r\n     * The model's name. This is the name you use from your app to load the\r\n     * model.\r\n     */\r\n    get displayName() {\r\n        return this.model.displayName;\r\n    }\r\n    /**\r\n     * The model's tags, which can be used to group or filter models in list\r\n     * operations.\r\n     */\r\n    get tags() {\r\n        return this.model.tags || [];\r\n    }\r\n    /** The timestamp of the model's creation. */\r\n    get createTime() {\r\n        return new Date(this.model.createTime).toUTCString();\r\n    }\r\n    /** The timestamp of the model's most recent update. */\r\n    get updateTime() {\r\n        return new Date(this.model.updateTime).toUTCString();\r\n    }\r\n    /** Error message when model validation fails. */\r\n    get validationError() {\r\n        return this.model.state?.validationError?.message;\r\n    }\r\n    /** True if the model is published. */\r\n    get published() {\r\n        return this.model.state?.published || false;\r\n    }\r\n    /**\r\n     * The ETag identifier of the current version of the model. This value\r\n     * changes whenever you update any of the model's properties.\r\n     */\r\n    get etag() {\r\n        return this.model.etag;\r\n    }\r\n    /**\r\n     * The hash of the model's `tflite` file. This value changes only when\r\n     * you upload a new TensorFlow Lite model.\r\n     */\r\n    get modelHash() {\r\n        return this.model.modelHash;\r\n    }\r\n    /** Metadata about the model's TensorFlow Lite model file. */\r\n    get tfliteModel() {\r\n        // Make a copy so people can't directly modify the private this.model object.\r\n        return (0, deep_copy_1.deepCopy)(this.model.tfliteModel);\r\n    }\r\n    /**\r\n     * True if the model is locked by a server-side operation. You can't make\r\n     * changes to a locked model. See {@link Model.waitForUnlocked}.\r\n     */\r\n    get locked() {\r\n        return (this.model.activeOperations?.length ?? 0) > 0;\r\n    }\r\n    /**\r\n     * Return the model as a JSON object.\r\n     */\r\n    toJSON() {\r\n        // We can't just return this.model because it has extra fields and\r\n        // different formats etc. So we build the expected model object.\r\n        const jsonModel = {\r\n            modelId: this.modelId,\r\n            displayName: this.displayName,\r\n            tags: this.tags,\r\n            createTime: this.createTime,\r\n            updateTime: this.updateTime,\r\n            published: this.published,\r\n            etag: this.etag,\r\n            locked: this.locked,\r\n        };\r\n        // Also add possibly undefined fields if they exist.\r\n        if (this.validationError) {\r\n            jsonModel['validationError'] = this.validationError;\r\n        }\r\n        if (this.modelHash) {\r\n            jsonModel['modelHash'] = this.modelHash;\r\n        }\r\n        if (this.tfliteModel) {\r\n            jsonModel['tfliteModel'] = this.tfliteModel;\r\n        }\r\n        return jsonModel;\r\n    }\r\n    /**\r\n     * Wait for the model to be unlocked.\r\n     *\r\n     * @param maxTimeMillis - The maximum time in milliseconds to wait.\r\n     *     If not specified, a default maximum of 2 minutes is used.\r\n     *\r\n     * @returns A promise that resolves when the model is unlocked\r\n     *   or the maximum wait time has passed.\r\n     */\r\n    waitForUnlocked(maxTimeMillis) {\r\n        if ((this.model.activeOperations?.length ?? 0) > 0) {\r\n            // The client will always be defined on Models that have activeOperations\r\n            // because models with active operations came back from the server and\r\n            // were constructed with a non-empty client.\r\n            return this.client.handleOperation(this.model.activeOperations[0], { wait: true, maxTimeMillis })\r\n                .then((modelResponse) => {\r\n                this.model = Model.validateAndClone(modelResponse);\r\n            });\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    static validateAndClone(model) {\r\n        if (!validator.isNonNullObject(model) ||\r\n            !validator.isNonEmptyString(model.name) ||\r\n            !validator.isNonEmptyString(model.createTime) ||\r\n            !validator.isNonEmptyString(model.updateTime) ||\r\n            !validator.isNonEmptyString(model.displayName) ||\r\n            !validator.isNonEmptyString(model.etag)) {\r\n            throw new machine_learning_utils_1.FirebaseMachineLearningError('invalid-server-response', `Invalid Model response: ${JSON.stringify(model)}`);\r\n        }\r\n        const tmpModel = (0, deep_copy_1.deepCopy)(model);\r\n        // If tflite Model is specified, it must have a source of {gcsTfliteUri}\r\n        if (model.tfliteModel &&\r\n            !validator.isNonEmptyString(model.tfliteModel.gcsTfliteUri)) {\r\n            // If we have some other source, ignore the whole tfliteModel.\r\n            delete tmpModel.tfliteModel;\r\n        }\r\n        // Remove '@type' field. We don't need it.\r\n        if (tmpModel['@type']) {\r\n            delete tmpModel['@type'];\r\n        }\r\n        return tmpModel;\r\n    }\r\n}\r\nexports.Model = Model;\r\nfunction extractModelId(resourceName) {\r\n    return resourceName.split('/').pop();\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}