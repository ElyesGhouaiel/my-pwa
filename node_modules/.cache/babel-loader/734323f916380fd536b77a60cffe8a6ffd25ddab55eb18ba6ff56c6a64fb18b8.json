{"ast":null,"code":"/*! firebase-admin v13.0.1 */\n\"use strict\";\n\n/*!\r\n * @license\r\n * Copyright 2017 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FirebaseMessagingRequestHandler = void 0;\nconst api_request_1 = require(\"../utils/api-request\");\nconst messaging_errors_internal_1 = require(\"./messaging-errors-internal\");\nconst index_1 = require(\"../utils/index\");\n// FCM backend constants\nconst FIREBASE_MESSAGING_TIMEOUT = 15000;\nconst FIREBASE_MESSAGING_HTTP_METHOD = 'POST';\nconst FIREBASE_MESSAGING_HEADERS = {\n  'X-Firebase-Client': `fire-admin-node/${(0, index_1.getSdkVersion)()}`,\n  'access_token_auth': 'true'\n};\n/**\r\n * Class that provides a mechanism to send requests to the Firebase Cloud Messaging backend.\r\n */\nclass FirebaseMessagingRequestHandler {\n  /**\r\n   * @param app - The app used to fetch access tokens to sign API requests.\r\n   * @constructor\r\n   */\n  constructor(app) {\n    this.httpClient = new api_request_1.AuthorizedHttpClient(app);\n    this.http2Client = new api_request_1.AuthorizedHttp2Client(app);\n  }\n  /**\r\n   * Invokes the request handler with the provided request data.\r\n   *\r\n   * @param host - The host to which to send the request.\r\n   * @param path - The path to which to send the request.\r\n   * @param requestData - The request data.\r\n   * @returns A promise that resolves with the response.\r\n   */\n  invokeRequestHandler(host, path, requestData) {\n    const request = {\n      method: FIREBASE_MESSAGING_HTTP_METHOD,\n      url: `https://${host}${path}`,\n      data: requestData,\n      headers: FIREBASE_MESSAGING_HEADERS,\n      timeout: FIREBASE_MESSAGING_TIMEOUT\n    };\n    return this.httpClient.send(request).then(response => {\n      // Send non-JSON responses to the catch() below where they will be treated as errors.\n      if (!response.isJson()) {\n        throw new api_request_1.RequestResponseError(response);\n      }\n      // Check for backend errors in the response.\n      const errorCode = (0, messaging_errors_internal_1.getErrorCode)(response.data);\n      if (errorCode) {\n        throw new api_request_1.RequestResponseError(response);\n      }\n      // Return entire response.\n      return response.data;\n    }).catch(err => {\n      if (err instanceof api_request_1.RequestResponseError) {\n        throw (0, messaging_errors_internal_1.createFirebaseError)(err);\n      }\n      // Re-throw the error if it already has the proper format.\n      throw err;\n    });\n  }\n  /**\r\n   * Invokes the HTTP/1.1 request handler with the provided request data.\r\n   *\r\n   * @param host - The host to which to send the request.\r\n   * @param path - The path to which to send the request.\r\n   * @param requestData - The request data.\r\n   * @returns A promise that resolves with the {@link SendResponse}.\r\n   */\n  invokeHttpRequestHandlerForSendResponse(host, path, requestData) {\n    const request = {\n      method: FIREBASE_MESSAGING_HTTP_METHOD,\n      url: `https://${host}${path}`,\n      data: requestData,\n      headers: FIREBASE_MESSAGING_HEADERS,\n      timeout: FIREBASE_MESSAGING_TIMEOUT\n    };\n    return this.httpClient.send(request).then(response => {\n      return this.buildSendResponse(response);\n    }).catch(err => {\n      if (err instanceof api_request_1.RequestResponseError) {\n        return this.buildSendResponseFromError(err);\n      }\n      // Re-throw the error if it already has the proper format.\n      throw err;\n    });\n  }\n  /**\r\n   * Invokes the HTTP/2 request handler with the provided request data.\r\n   *\r\n   * @param host - The host to which to send the request.\r\n   * @param path - The path to which to send the request.\r\n   * @param requestData - The request data.\r\n   * @returns A promise that resolves with the {@link SendResponse}.\r\n   */\n  invokeHttp2RequestHandlerForSendResponse(host, path, requestData, http2SessionHandler) {\n    const request = {\n      method: FIREBASE_MESSAGING_HTTP_METHOD,\n      url: `https://${host}${path}`,\n      data: requestData,\n      headers: FIREBASE_MESSAGING_HEADERS,\n      timeout: FIREBASE_MESSAGING_TIMEOUT,\n      http2SessionHandler: http2SessionHandler\n    };\n    return this.http2Client.send(request).then(response => {\n      return this.buildSendResponse(response);\n    }).catch(err => {\n      if (err instanceof api_request_1.RequestResponseError) {\n        return this.buildSendResponseFromError(err);\n      }\n      // Re-throw the error if it already has the proper format.\n      throw err;\n    });\n  }\n  buildSendResponse(response) {\n    const result = {\n      success: response.status === 200\n    };\n    if (result.success) {\n      result.messageId = response.data.name;\n    } else {\n      result.error = (0, messaging_errors_internal_1.createFirebaseError)(new api_request_1.RequestResponseError(response));\n    }\n    return result;\n  }\n  buildSendResponseFromError(err) {\n    return {\n      success: false,\n      error: (0, messaging_errors_internal_1.createFirebaseError)(err)\n    };\n  }\n}\nexports.FirebaseMessagingRequestHandler = FirebaseMessagingRequestHandler;","map":{"version":3,"names":["Object","defineProperty","exports","value","FirebaseMessagingRequestHandler","api_request_1","require","messaging_errors_internal_1","index_1","FIREBASE_MESSAGING_TIMEOUT","FIREBASE_MESSAGING_HTTP_METHOD","FIREBASE_MESSAGING_HEADERS","getSdkVersion","constructor","app","httpClient","AuthorizedHttpClient","http2Client","AuthorizedHttp2Client","invokeRequestHandler","host","path","requestData","request","method","url","data","headers","timeout","send","then","response","isJson","RequestResponseError","errorCode","getErrorCode","catch","err","createFirebaseError","invokeHttpRequestHandlerForSendResponse","buildSendResponse","buildSendResponseFromError","invokeHttp2RequestHandlerForSendResponse","http2SessionHandler","result","success","status","messageId","name","error"],"sources":["C:/Users/yujir/Documents/ynov/app pwa/mypwafinal/my-pwa/node_modules/firebase-admin/lib/messaging/messaging-api-request-internal.js"],"sourcesContent":["/*! firebase-admin v13.0.1 */\r\n\"use strict\";\r\n/*!\r\n * @license\r\n * Copyright 2017 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.FirebaseMessagingRequestHandler = void 0;\r\nconst api_request_1 = require(\"../utils/api-request\");\r\nconst messaging_errors_internal_1 = require(\"./messaging-errors-internal\");\r\nconst index_1 = require(\"../utils/index\");\r\n// FCM backend constants\r\nconst FIREBASE_MESSAGING_TIMEOUT = 15000;\r\nconst FIREBASE_MESSAGING_HTTP_METHOD = 'POST';\r\nconst FIREBASE_MESSAGING_HEADERS = {\r\n    'X-Firebase-Client': `fire-admin-node/${(0, index_1.getSdkVersion)()}`,\r\n    'access_token_auth': 'true',\r\n};\r\n/**\r\n * Class that provides a mechanism to send requests to the Firebase Cloud Messaging backend.\r\n */\r\nclass FirebaseMessagingRequestHandler {\r\n    /**\r\n     * @param app - The app used to fetch access tokens to sign API requests.\r\n     * @constructor\r\n     */\r\n    constructor(app) {\r\n        this.httpClient = new api_request_1.AuthorizedHttpClient(app);\r\n        this.http2Client = new api_request_1.AuthorizedHttp2Client(app);\r\n    }\r\n    /**\r\n     * Invokes the request handler with the provided request data.\r\n     *\r\n     * @param host - The host to which to send the request.\r\n     * @param path - The path to which to send the request.\r\n     * @param requestData - The request data.\r\n     * @returns A promise that resolves with the response.\r\n     */\r\n    invokeRequestHandler(host, path, requestData) {\r\n        const request = {\r\n            method: FIREBASE_MESSAGING_HTTP_METHOD,\r\n            url: `https://${host}${path}`,\r\n            data: requestData,\r\n            headers: FIREBASE_MESSAGING_HEADERS,\r\n            timeout: FIREBASE_MESSAGING_TIMEOUT,\r\n        };\r\n        return this.httpClient.send(request).then((response) => {\r\n            // Send non-JSON responses to the catch() below where they will be treated as errors.\r\n            if (!response.isJson()) {\r\n                throw new api_request_1.RequestResponseError(response);\r\n            }\r\n            // Check for backend errors in the response.\r\n            const errorCode = (0, messaging_errors_internal_1.getErrorCode)(response.data);\r\n            if (errorCode) {\r\n                throw new api_request_1.RequestResponseError(response);\r\n            }\r\n            // Return entire response.\r\n            return response.data;\r\n        })\r\n            .catch((err) => {\r\n            if (err instanceof api_request_1.RequestResponseError) {\r\n                throw (0, messaging_errors_internal_1.createFirebaseError)(err);\r\n            }\r\n            // Re-throw the error if it already has the proper format.\r\n            throw err;\r\n        });\r\n    }\r\n    /**\r\n     * Invokes the HTTP/1.1 request handler with the provided request data.\r\n     *\r\n     * @param host - The host to which to send the request.\r\n     * @param path - The path to which to send the request.\r\n     * @param requestData - The request data.\r\n     * @returns A promise that resolves with the {@link SendResponse}.\r\n     */\r\n    invokeHttpRequestHandlerForSendResponse(host, path, requestData) {\r\n        const request = {\r\n            method: FIREBASE_MESSAGING_HTTP_METHOD,\r\n            url: `https://${host}${path}`,\r\n            data: requestData,\r\n            headers: FIREBASE_MESSAGING_HEADERS,\r\n            timeout: FIREBASE_MESSAGING_TIMEOUT,\r\n        };\r\n        return this.httpClient.send(request).then((response) => {\r\n            return this.buildSendResponse(response);\r\n        })\r\n            .catch((err) => {\r\n            if (err instanceof api_request_1.RequestResponseError) {\r\n                return this.buildSendResponseFromError(err);\r\n            }\r\n            // Re-throw the error if it already has the proper format.\r\n            throw err;\r\n        });\r\n    }\r\n    /**\r\n     * Invokes the HTTP/2 request handler with the provided request data.\r\n     *\r\n     * @param host - The host to which to send the request.\r\n     * @param path - The path to which to send the request.\r\n     * @param requestData - The request data.\r\n     * @returns A promise that resolves with the {@link SendResponse}.\r\n     */\r\n    invokeHttp2RequestHandlerForSendResponse(host, path, requestData, http2SessionHandler) {\r\n        const request = {\r\n            method: FIREBASE_MESSAGING_HTTP_METHOD,\r\n            url: `https://${host}${path}`,\r\n            data: requestData,\r\n            headers: FIREBASE_MESSAGING_HEADERS,\r\n            timeout: FIREBASE_MESSAGING_TIMEOUT,\r\n            http2SessionHandler: http2SessionHandler\r\n        };\r\n        return this.http2Client.send(request).then((response) => {\r\n            return this.buildSendResponse(response);\r\n        })\r\n            .catch((err) => {\r\n            if (err instanceof api_request_1.RequestResponseError) {\r\n                return this.buildSendResponseFromError(err);\r\n            }\r\n            // Re-throw the error if it already has the proper format.\r\n            throw err;\r\n        });\r\n    }\r\n    buildSendResponse(response) {\r\n        const result = {\r\n            success: response.status === 200,\r\n        };\r\n        if (result.success) {\r\n            result.messageId = response.data.name;\r\n        }\r\n        else {\r\n            result.error = (0, messaging_errors_internal_1.createFirebaseError)(new api_request_1.RequestResponseError(response));\r\n        }\r\n        return result;\r\n    }\r\n    buildSendResponseFromError(err) {\r\n        return {\r\n            success: false,\r\n            error: (0, messaging_errors_internal_1.createFirebaseError)(err)\r\n        };\r\n    }\r\n}\r\nexports.FirebaseMessagingRequestHandler = FirebaseMessagingRequestHandler;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}